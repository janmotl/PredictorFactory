<?xml version="1.0" encoding="utf-8" standalone="yes"?>

<pattern>
	<name>Entropy continuous</name>
	<description>
		Entropy estimate for numerical attributes.

		The calculation is based on page 13 of:
			http://www.slideshare.net/DataRobot/featurizing-log-data-before-xgboost

		This pattern can be slow.

		Note: To avoid integer division, we multiply the "sum" by 1.0 to cast it to numerical.

		Note: We may get error that we cannot take logarithm of zero/negative number.
	</description>
	<example>

	</example>
	<author>Matej Polak</author>
	<date>2017-01-16</date>
	<code compatibility="MySQL,PostgreSQL">
		SELECT a.@base,
			- SUM(@numericalColumn/sum * LN(@numericalColumn/sum)) AS @columnName
		FROM @propagatedTable a
		INNER JOIN (
			SELECT @basePartitionBy, COUNT(*) count, SUM( @numericalColumn) * 1.0 sum
			FROM @propagatedTable
			GROUP BY @basePartitionBy
		) stats
		USING(@basePartitionBy)
		GROUP BY a.@base
	</code>
	<cardinality>n</cardinality>
</pattern>
