<?xml version="1.0" encoding="utf-8" standalone="yes"?>

<pattern>
	<name>Nominal change</name>
	<description>
		Count of changes of a nominal attribute in time.
	</description>
	<author>Jan Motl</author>
	<date>2015-03-14</date>
	<code compatibility="PostgreSQL">WITH intermediate AS (
			SELECT @base
				 , @nominalColumn AS nowValue
				 , LAG(@nominalColumn) OVER (PARTITION BY @basePartitionBy ORDER BY @timeColumn) AS lagValue
			FROM @propagatedTable
		  )
		  SELECT @base
			   , sum(CASE WHEN nowValue &lt;&gt; lagValue THEN 1 ELSE 0 END) AS @columnName
		  FROM intermediate
		  GROUP BY @base
	</code>
	<cardinality>n</cardinality>
</pattern>
