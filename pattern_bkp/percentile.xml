<?xml version="1.0" encoding="utf-8" standalone="yes"?>

<pattern>
	<name>Percentile</name>
	<description>Percentiles
	
	Note: The implementation for PostgreSQL is supported from PostgreSQL 9.4.
	Note: Schizofrenic window functions - PostgreSQL requires "group by", MSSQL requires "over".
	</description>
	<author>Jan Motl</author>
	<date>2014-12-22</date>
	<code compatibility="PostgreSQL">SELECT @base
	           , percentile_cont(@value) WITHIN GROUP (ORDER BY @numericalColumn) AS @columnName
		   FROM @propagatedTable
		   GROUP BY @base
	</code>
	<code compatibility="Microsoft SQL Server">SELECT DISTINCT @base
	           , percentile_cont(@value) WITHIN GROUP (ORDER BY @numericalColumn) OVER (PARTITION BY @basePartitionBy) AS @columnName
		   FROM @propagatedTable
	</code>
	<parameter key="@value" value="0.05, 0.5, 0.95"/>
	<cardinality>n</cardinality>
</pattern>
