CREATE TABLE `predictor_factory`.`propagated_loan_001` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`base_sampled` t1 INNER JOIN `financial`.`loan` t2 ON t1.`propagated_id` = t2.`account_id`;
CREATE TABLE `predictor_factory`.`propagated_account_002` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_loan_001` t1 INNER JOIN `financial`.`account` t2 ON t1.`account_id` = t2.`account_id`;
CREATE TABLE `predictor_factory`.`propagated_district_003` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_account_002` t1 INNER JOIN `financial`.`district` t2 ON t1.`district_id` = t2.`district_id`;
CREATE TABLE `predictor_factory`.`propagated_disp_004` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_account_002` t1 INNER JOIN `financial`.`disp` t2 ON t1.`account_id` = t2.`account_id`;
CREATE TABLE `predictor_factory`.`propagated_order_005` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_account_002` t1 INNER JOIN `financial`.`order` t2 ON t1.`account_id` = t2.`account_id`;
CREATE TABLE `predictor_factory`.`propagated_trans_006` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_account_002` t1 INNER JOIN `financial`.`trans` t2 ON t1.`account_id` = t2.`account_id` WHERE t2.`date` <= DATE_ADD(`propagated_date`, INTERVAL -0 month) AND DATE_ADD(`propagated_date`, INTERVAL -240 month) <= t2.`date`;
CREATE TABLE `predictor_factory`.`propagated_client_007` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_district_003` t1 INNER JOIN `financial`.`client` t2 ON t1.`district_id` = t2.`district_id` WHERE t2.`birth_date` <= DATE_ADD(`propagated_date`, INTERVAL -0 month) AND DATE_ADD(`propagated_date`, INTERVAL -240 month) <= t2.`birth_date`;
CREATE TABLE `predictor_factory`.`propagated_client_008` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_disp_004` t1 INNER JOIN `financial`.`client` t2 ON t1.`client_id` = t2.`client_id`;
CREATE TABLE `predictor_factory`.`propagated_card_009` AS SELECT t1.`propagated_id`, t1.`propagated_date`, t1.`propagated_target`, t1.`propagated_fold`, t2.* FROM `predictor_factory`.`propagated_disp_004` t1 INNER JOIN `financial`.`card` t2 ON t1.`disp_id` = t2.`disp_id`;
