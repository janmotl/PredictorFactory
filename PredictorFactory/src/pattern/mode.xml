<?xml version="1.0" encoding="utf-8" standalone="yes"?>

<pattern>
	<name>Mode</name>
	<description>Mode
	
	NOTE: Works also on id!
	
	Note: The implementation for PostgreSQL is supported from PostgreSQL 9.4.
	</description>
	<example>
		The typical payment amount.
	</example>
	<author>Jan Motl</author>
	<date>2014-12-22</date>
	<code compatibility="PostgreSQL">SELECT @baseId
	           , @baseDate
	           , @baseTarget
	           , mode() WITHIN GROUP (ORDER BY @column) AS "@columnName"
		   FROM @propagatedTable
		   GROUP BY @baseId, @baseDate, @baseTarget
	</code>
	<code compatibility="Microsoft SQL Server">SELECT @baseId
	           , @baseDate
	           , @baseTarget
	           , (
	           		SELECT TOP 1 @column 
					FROM @propagatedTable t2 
					WHERE t.@baseId = t2.@baseId AND t.@baseDate = t2.@baseDate
					GROUP BY @column ORDER BY count(*) desc
				) AS "@columnName"
			FROM  @propagatedTable  t
			GROUP BY @baseId, @baseDate, @baseTarget
	</code>
	<parameter key="@column" value="@nominalColumn, @numericalColumn"/>
	<cardinality>n</cardinality>
</pattern>
